(self.webpackChunkatk=self.webpackChunkatk||[]).push([[507],{33843:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});i(92222),i(57327),i(34553),i(89554),i(66992),i(68309),i(41539),i(70189),i(78783),i(88921),i(96248),i(13599),i(11477),i(64362),i(15389),i(90401),i(45164),i(91238),i(54837),i(87485),i(56767),i(76651),i(61437),i(35285),i(39865),i(54747),i(33948);var n=i(319),s=i.n(n);const o={template:'<div class="item" :style="itemMargin">\n        <i :class="toggleIcon" @click="onToggleShow" v-show="!isRoot"></i>\n        <i :class="getIcon"  @click="onToggleSelect" v-show="!isRoot"></i>\n        <div class="content" >\n          <div @click="onToggleSelect" :style="itemCursor">{{title}}</div>\n          <div class="list" v-show="open || isRoot" v-if="isParent" >\n            <atk-tree-item-selector v-for="(item, index) in item.nodes" :key="item.id" :item="item" :values="values">\n            </atk-tree-item-selector>\n          </div>\n        </div>\n     </div>',props:{item:Object,values:Array},inject:["getRootData"],name:"atk-tree-item-selector",data:function(){return{open:!1,isRoot:"atk-root"===this.item.id,isInitialized:!1,id:this.item.id,nodes:this.item.nodes,icons:{single:{on:"circle icon",off:"circle outline icon",indeterminate:"dot circle outline icon"},multiple:{on:"check square outline icon",off:"square outline icon",indeterminate:"minus square outline icon"}}}},created:function(){this.getInitData()},mounted:function(){},computed:{itemMargin:function(){return{marginLeft:this.item.nodes&&this.item.nodes.length>0?this.open?"-13px":"-10px":null}},itemCursor:function(){return{cursor:this.isParent&&"single"===this.getRootData().options.mode?"default":"pointer"}},title:function(){return this.item.name},isParent:function(){return this.nodes&&this.nodes.length>0},toggleIcon:function(){return this.isParent?this.open?"caret down icon":"caret right icon":null},state:function(){var t="off";return this.isParent?t=this.hasAllFill(this.nodes)?"on":this.hasSomeFill(this.nodes)?"indeterminate":"off":this.isSelected(this.id)&&(t="on"),t},getIcon:function(){return this.icons[this.getRootData().options.mode][this.state]}},methods:{isSelected:function(t){return this.values.filter((function(e){return e===t})).length>0},getInitData:function(){this.getRootData().item.isInitialized||(this.getRootData().values=this.getValues(),this.getRootData().item.isInitialized=!0)},getValues:function(){var t=JSON.parse(this.getInputElement().value),e=[];return Array.isArray(t)?e=t:e.push(t),e},hasAllFill:function(t){for(var e=this,i=!0,n=function(n){if(t[n].nodes&&t[n].nodes.length>0){if(!e.hasAllFill(t[n].nodes))return i=!1,"break"}else if(-1===e.values.findIndex((function(e){return e===t[n].id})))return i=!1,"break"},s=0;s<t.length;s++){if("break"===n(s))break}return i},hasSomeFill:function(t){for(var e=this,i=!1,n=function(n){return t[n].nodes&&t[n].nodes.length>0&&e.hasSomeFill(t[n].nodes)||e.values.findIndex((function(e){return e===t[n].id}))>-1?(i=!0,"break"):void 0},s=0;s<t.length;s++){if("break"===n(s))break}return i},onToggleShow:function(){this.isParent&&(this.open=!this.open)},onToggleSelect:function(){switch(this.getRootData().options.mode){case"single":this.handleSingleSelect();break;case"multiple":this.handleMultipleSelect()}},mergeArrays:function(){for(var t=[],e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((function(e){t=[].concat(s()(t),s()(e))})),s()(new Set(s()(t)))},collectAllChildren:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((function(t){t.nodes&&t.nodes.length>0?i.concat(e.collectAllChildren(t.nodes,i)):i.push(t.id)})),i},remove:function(t,e){return t.filter((function(t){return t!==e}))},handleSingleSelect:function(){"off"!==this.state||this.isParent||(this.getRootData().values=[this.item.id],this.setInput(this.item.id),this.getRootData().options.url&&this.postValue()),this.isParent&&(this.open=!this.open)},handleMultipleSelect:function(){var t,e=this;if(this.isParent){var i=this.collectAllChildren(this.nodes);if("off"===this.state||"indeterminate"===this.state)t=this.mergeArrays(this.values,i);else{var n=this.values;i.forEach((function(t){n=e.remove(n,t)})),t=n}}else"on"===this.state?t=this.remove(this.values,this.item.id):"off"===this.state&&(t=this.values).push(this.item.id);this.getRootData().values=s()(t),this.setInput(JSON.stringify(t)),this.getRootData().options.url&&this.postValue()},setInput:function(t){this.getInputElement().value=t},getInputElement:function(){return document.getElementsByName(this.getRootData().field)[0]},postValue:function(){jQuery(this.$el).parents("."+this.getRootData().options.loader).api({on:"now",url:this.getRootData().options.url,method:"post",data:{data:JSON.stringify(this.getRootData().values)}})}}}}}]);