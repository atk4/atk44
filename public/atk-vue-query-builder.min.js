(self.webpackChunkatk=self.webpackChunkatk||[]).push([[662],{47537:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(6479),a=r.n(n);const i={name:"atk-date-picker",template:'<flat-picker v-model="date" :config="flatPickr" @on-change="onChange"></flat-picker>',props:["config","value"],data:function(){var e=this.config,t=e.useDefault,r=a()(e,["useDefault"]);return!t||r.defaultDate||this.value?this.value&&(r.defaultDate=this.value):r.defaultDate=new Date,r.locale||(r.locale=flatpickr.l10ns.default),{flatPickr:r,date:null}},mounted:function(){!this.value&&this.flatPickr.defaultDate&&(this.flatPickr.defaultDate instanceof Date?this.$emit("setDefault",flatpickr.formatDate(this.config.defaultDate,this.config.dateFormat)):this.$emit("setDefault",this.flatPickr.defaultDate))},methods:{onChange:function(e){this.$emit("onChange",flatpickr.formatDate(e[0],this.flatPickr.dateFormat))}}}},72549:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(87757),a=r.n(n),i=(r(35666),r(48926)),u=r.n(i),l=r(6479),o=r.n(l),s=r(11502);const c={name:"atk-lookup",template:'<sui-dropdown \n                    ref="drop"\n                    v-bind="dropdownProps" \n                    :loading="isLoading" \n                    @input="onChange" \n                    @filtered="onFiltered" \n                    v-model="current" \n                    :class="css"></sui-dropdown>',props:["config","value","optionalValue"],data:function(){var e=this.config,t=e.url,r=e.reference,n=e.ui,a=o()(e,["url","reference","ui"]);return a.selection=!0,{dropdownProps:a,current:this.value,url:t||null,css:[n],isLoading:!1,field:r,query:"",temp:""}},mounted:function(){this.optionalValue&&(this.dropdownProps.options=(0,s.kJ)(this.optionalValue)?this.optionalValue:[this.optionalValue])},methods:{onChange:function(e){this.$emit("onChange",e)},onFiltered:function(e){var t=this;e&&(this.isLoading=!0),this.temp=e,atk.debounce((function(){t.query!==t.temp&&(t.query=t.temp,t.query&&t.fetchItems(t.query))}),300).call(this)},fetchItems:(d=u()(a().mark((function e(t){var r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={atk_vlookup_q:t,atk_vlookup_field:this.field},e.next=4,atk.apiService.suiFetch(this.url,{method:"get",data:r});case 4:(n=e.sent).success&&(this.dropdownProps.options=n.results),this.isLoading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),this.isLoading=!1;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return d.apply(this,arguments)})}};var d},41290:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(23645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,"\n.atk-qb-select, .ui.form select.atk-qb-select {\n   padding: 2px 6px 4px 4px;\n}\n.atk-qb-remove {\n    cursor: pointer;\n    color: rgba(0,0,0,0.6);\n}\n.ui.selection.dropdown.atk-qb-rule-select {\n    background-color: rgba(0,0,0,0);\n}\n.ui.selection.dropdown .atk-qb-rule-select-menu {\n    width: max-content;\n    z-index: 1000;\n}\n.vbq-group-heading > .ui.grid > .column:not(.row) {\n    padding-bottom: 0.5em;\n    padding-top: 0.5em;\n}\n.vue-query-builder .ui.card.compact {\n    margin-top: 0.5em;\n    margin-bottom: 0.5em;\n}\n.vue-query-builder .ui.card.fitted {\n    margin-top: 0em;\n    margin-bottom: 0em;\n}\n.vue-query-builder .ui.card.padded {\n    margin-top: 1em;\n    margin-bottom: 1em;\n}\n.ui.card > .vbq-group-heading.content {\n    background-color: #f3f4f5;\n}\n.vue-query-builder .vqb-group.depth-1 .vqb-rule,\n.vue-query-builder .vqb-group.depth-2 {\n    border-left: 2px solid #8bc34a;\n}\n.vue-query-builder .vqb-group.depth-2 .vqb-rule,\n.vue-query-builder .vqb-group.depth-3 {\n    border-left: 2px solid #00bcd4;\n}\n.vue-query-builder .vqb-group.depth-3 .vqb-rule,\n.vue-query-builder .vqb-group.depth-4 {\n    border-left: 2px solid #ff5722;\n}\n\n",""]);const i=a},3811:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(23645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,"\n.ui.input.atk-qb > input, .ui.input.atk-qb span > input, .ui.form .input.atk-qb {\n    padding: 6px;\n}\n.ui.grid > .row.atk-qb {\n    padding: 8px 0px;\n    min-height: 62px;\n}\n.inline.fields.atk-qb, .ui.form .inline.fields.atk-qb {\n    margin: 0px;\n}\n.atk-qb-date-picker {\n    border: 1px solid rgba(34, 36, 38, 0.15);\n}\ninput[type=input].atk-qb-date-picker:focus {\n    border-color: #85b7d9;\n}\n.ui.card.vqb-rule > .content {\n    padding-bottom: 0.5em;\n    padding-top: 0.5em;\n    background-color: #f3f4f5;\n}\n",""]);const i=a},88691:(e,t,r)=>{var n=r(93379),a=r(41290);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.id,a,""]]);var i={insert:"head",singleton:!1};n(a,i);e.exports=a.locals||{}},9526:(e,t,r)=>{var n=r(93379),a=r(3811);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.id,a,""]]);var i={insert:"head",singleton:!1};n(a,i);e.exports=a.locals||{}},64026:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},[r("input",{attrs:{form:e.form,name:e.name,type:"hidden"},domProps:{value:e.value}}),e._v(" "),r("vue-query-builder",{attrs:{rules:e.rules,maxDepth:e.maxDepth,labels:e.labels},scopedSlots:e._u([{key:"default",fn:function(t){return[r("query-builder-group",e._b({attrs:{query:e.query},on:{"update:query":function(t){e.query=t}}},"query-builder-group",t,!1))]}}]),model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),e._v(" "),e.debug?[r("pre",[e._v(e._s(JSON.stringify(this.query,null,2)))])]:e._e()],2)};n._withStripped=!0;r(68309);var a=r(59713),i=r.n(a),u=r(56062),l=r.n(u),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"vqb-group ui fluid card",class:[e.labels.spaceRule,"depth-"+e.depth.toString()]},[r("div",{staticClass:"vbq-group-heading content",class:"depth-"+e.depth.toString()},[r("div",{staticClass:"ui grid"},[r("div",{staticClass:"fourteen wide column"},[r("div",{staticClass:"ui horizontal list"},[r("div",{staticClass:"item"},[r("h4",{staticClass:"ui inline"},[e._v(e._s(e.labels.matchType))])]),e._v(" "),r("div",{staticClass:"item"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.query.logicalOperator,expression:"query.logicalOperator"}],staticClass:"atk-qb-select",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.query,"logicalOperator",t.target.multiple?r:r[0])}}},e._l(e.labels.matchTypes,(function(t){return r("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.label))])})),0)]),e._v(" "),r("div",{staticClass:"item"},[r("div",{staticClass:"rule-actions "},[r("div",[r("sui-dropdown",{staticClass:"ui mini basic button atk-qb-rule-select",attrs:{text:e.labels.addRule,selection:""}},[r("sui-dropdown-menu",{staticClass:"atk-qb-rule-select-menu"},e._l(e.rules,(function(t){return r("sui-dropdown-item",{key:t.id,attrs:{value:t},on:{click:function(r){return e.addNewRule(t.id)}}},[e._v(e._s(t.label))])})),1)],1),e._v(" "),e.depth<e.maxDepth?r("button",{staticClass:"ui mini basic button",attrs:{type:"button"},on:{click:e.addGroup}},[e._v(e._s(e.labels.addGroup))]):e._e()],1)])])])]),e._v(" "),r("div",{staticClass:"two wide right aligned column"},[e.depth>1?r("i",{staticClass:"atk-qb-remove",class:e.labels.removeGroup,on:{click:e.remove}}):e._e()])])]),e._v(" "),r("div",{staticClass:"vbq-group-body content"},[r("query-builder-children",e._b({},"query-builder-children",e.$props,!1))],1)])};o._withStripped=!0;r(57327),r(21249);var s=r(75338),c=r.n(s),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"vqb-rule ui fluid card",class:e.labels.spaceRule,attrs:{"data-name":e.rule.id}},[r("div",{staticClass:"content"},[r("div",{staticClass:"ui grid"},[r("div",{staticClass:"middle aligned row atk-qb"},[r("div",{staticClass:"thirteen wide column"},[r("div",{staticClass:"ui horizontal list"},[r("div",{staticClass:"item vqb-rule-label"},[r("h5",{},[e._v(e._s(e.rule.label))])]),e._v(" "),void 0!==e.rule.operands?r("div",{staticClass:"item vqb-rule-operand"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.query.operand,expression:"query.operand"}],staticClass:"atk-qb-select",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.query,"operand",t.target.multiple?r:r[0])}}},e._l(e.rule.operands,(function(t){return r("option",{key:t},[e._v(e._s(t))])})),0)]):e._e(),e._v(" "),void 0!==e.rule.operators&&e.rule.operators.length>1?r("div",{staticClass:"item vqb-rule-operator"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.query.operator,expression:"query.operator"}],staticClass:"atk-qb-select",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.query,"operator",t.target.multiple?r:r[0])}}},e._l(e.rule.operators,(function(t){return r("option",{key:t,domProps:{value:t}},[e._v("\n                                    "+e._s(t)+"\n                                ")])})),0)]):e._e(),e._v(" "),r("div",{staticClass:"item vqb-rule-input"},[e.canDisplay("input")?[r("div",{staticClass:"ui small input atk-qb"},["checkbox"===e.rule.inputType?r("input",{directives:[{name:"model",rawName:"v-model",value:e.query.value,expression:"query.value"}],attrs:{placeholder:e.labels.textInputPlaceholder,type:"checkbox"},domProps:{checked:Array.isArray(e.query.value)?e._i(e.query.value,null)>-1:e.query.value},on:{change:function(t){var r=e.query.value,n=t.target,a=!!n.checked;if(Array.isArray(r)){var i=e._i(r,null);n.checked?i<0&&e.$set(e.query,"value",r.concat([null])):i>-1&&e.$set(e.query,"value",r.slice(0,i).concat(r.slice(i+1)))}else e.$set(e.query,"value",a)}}}):"radio"===e.rule.inputType?r("input",{directives:[{name:"model",rawName:"v-model",value:e.query.value,expression:"query.value"}],attrs:{placeholder:e.labels.textInputPlaceholder,type:"radio"},domProps:{checked:e._q(e.query.value,null)},on:{change:function(t){return e.$set(e.query,"value",null)}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:e.query.value,expression:"query.value"}],attrs:{placeholder:e.labels.textInputPlaceholder,type:e.rule.inputType},domProps:{value:e.query.value},on:{input:function(t){t.target.composing||e.$set(e.query,"value",t.target.value)}}})])]:e._e(),e._v(" "),e.canDisplay("checkbox")?[r("sui-form-fields",{staticClass:"atk-qb",attrs:{inline:""}},e._l(e.rule.choices,(function(t){return r("div",{key:t.value,staticClass:"field"},[r("sui-checkbox",{attrs:{label:t.label,radio:e.isRadio,value:t.value},model:{value:e.query.value,callback:function(t){e.$set(e.query,"value",t)},expression:"query.value"}})],1)})),0)]:e._e(),e._v(" "),e.canDisplay("select")?[r("select",{directives:[{name:"model",rawName:"v-model",value:e.query.value,expression:"query.value"}],staticClass:"atk-qb-select",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.query,"value",t.target.multiple?r:r[0])}}},e._l(e.rule.choices,(function(t){return r("option",{key:t.value,domProps:{value:t.value}},[e._v("\n                                        "+e._s(t.label)+"\n                                    ")])})),0)]:e._e(),e._v(" "),e.canDisplay("custom-component")?[r("div",{staticClass:"ui small input atk-qb"},[r(e.rule.component,{tag:"component",attrs:{config:e.rule.componentProps,value:e.query.value,optionalValue:e.query.option},on:{onChange:e.onChange,setDefault:e.onChange}})],1)]:e._e()],2)])]),e._v(" "),r("div",{staticClass:"right aligned three wide column"},[r("i",{staticClass:"atk-qb-remove",class:e.labels.removeRule,on:{click:e.remove}})])])])])])};d._withStripped=!0;r(26699),r(32023);var p=r(99593),v=r.n(p),m=r(47537),h=r(72549);const f={extends:v(),components:{"atk-date-picker":m.Z,"atk-lookup":h.Z},data:function(){return{}},inject:["getRootData"],computed:{isInput:function(){return"text"===this.rule.type||"numeric"===this.rule.type},isComponent:function(){return"custom-component"===this.rule.type},isRadio:function(){return"radio"===this.rule.type},isCheckbox:function(){return"checkbox"===this.rule.type||this.isRadio},isSelect:function(){return"select"===this.rule.type}},methods:{canDisplay:function(e){if(this.labels.hiddenOperator.includes(this.query.operator))return!1;switch(e){case"input":return this.isInput;case"checkbox":return this.isCheckbox;case"select":return this.isSelect;case"custom-component":return this.isComponent;default:return!1}},onChange:function(e){this.query.value=e}}};r(30579);var b=r(51900),y=(0,b.Z)(f,d,[],!1,null,null,null);y.options.__file="src/components/query-builder/fomantic-ui-rule.component.vue";const g={name:"QueryBuilderGroup",components:{QueryBuilderRule:y.exports},data:function(){return{selectedSuiRule:null}},methods:{addNewRule:function(e){this.selectedRule=this.rules.filter((function(t){return t.id===e}))[0],this.selectedRule&&this.addRule()}},computed:{dropdownRules:function(){return this.rules.map((function(e){return{key:e.id,text:e.label,value:e.id}}))}},extends:c()};r(71317);var q=(0,b.Z)(g,o,[],!1,null,null,null);q.options.__file="src/components/query-builder/fomantic-ui-group.component.vue";const k=q.exports;function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}const x={name:"query-builder",components:{VueQueryBuilder:l(),QueryBuilderGroup:k},props:{data:Object},data:function(){return{query:this.data.query?this.data.query:{},rules:this.data.rules?this.data.rules:[],name:this.data.name?this.data.name:"",maxDepth:this.data.maxDepth?this.data.maxDepth<=10?this.data.maxDepth:10:1,labels:this.getLabels(this.data.labels),form:this.data.form,debug:!!this.data.debug&&this.data.debug}},computed:{value:function(){return JSON.stringify(this.query,null)}},methods:{getLabels:function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({matchType:"Match Type",matchTypes:[{id:"AND",label:"And"},{id:"OR",label:"Or"}],addRule:"Add Rule",removeRule:"small icon times",addGroup:"Add Group",removeGroup:"small icon times",textInputPlaceholder:"value",spaceRule:"fitted",hiddenOperator:["is empty","is not empty"]},e=e||{})}}};var C=(0,b.Z)(x,n,[],!1,null,null,null);C.options.__file="src/components/query-builder/query-builder.component.vue";const w=C.exports},71317:(e,t,r)=>{var n=r(88691);"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,r(45346).Z)("2beecd00",n,!1,{})},30579:(e,t,r)=>{var n=r(9526);"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,r(45346).Z)("78558b40",n,!1,{})}}]);